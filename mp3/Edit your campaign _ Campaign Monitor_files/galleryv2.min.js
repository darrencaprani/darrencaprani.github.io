/*
 AngularJS v1.2.11
 (c) 2010-2014 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(a,h,n){h.module("ngAnimate",["ng"]).factory("$$animateReflow",["$window","$timeout",function(a,c){var b=a.requestAnimationFrame||a.webkitRequestAnimationFrame||function(a){return c(a,10,!1)},d=a.cancelAnimationFrame||a.webkitCancelAnimationFrame||function(a){return c.cancel(a)};return function(a){var c=b(a);return function(){d(c)}}}]).config(["$provide","$animateProvider",function(f,c){function b(a){for(var c=0;c<a.length;c++){var b=a[c];if(b.nodeType==q)return b}}var d=h.noop,g=h.forEach,
p=c.$$selectors,q=1,s="$$ngAnimateState",w="ng-animate",i={running:!0};f.decorator("$animate",["$delegate","$injector","$sniffer","$rootElement","$timeout","$rootScope","$document",function(a,f,n,q,x,t){function N(a){if(a){var c=[],b={},a=a.substr(1).split(".");(n.transitions||n.animations)&&a.push("");for(var j=0;j<a.length;j++){var l=a[j],d=p[l];d&&!b[l]&&(c.push(f.get(d)),b[l]=!0)}return c}}function o(a,c,r,j,l,h,n){function m(a){i();if(a===!0)q();else{if(a=r.data(s))a.done=q,r.data(s,a);f(u,"after",
q)}}function f(e,b,j){b=="after"?G():k();var l=b+"End";g(e,function(k,Z){var S=function(){a:{var a=b+"Complete",c=e[Z];c[a]=!0;(c[l]||d)();for(c=0;c<e.length;c++)if(!e[c][a])break a;j()}};b=="before"&&(a=="enter"||a=="move")?S():k[b]?k[l]=t?k[b](r,c,S):k[b](r,S):S()})}function e(e){r.triggerHandler("$animate:"+e,{event:a,className:c})}function k(){x(function(){e("before")},0,!1)}function G(){x(function(){e("after")},0,!1)}function H(){x(function(){e("close");n&&n()},0,!1)}function i(){if(!i.hasBeenRun)i.hasBeenRun=
!0,h()}function q(){if(!q.hasBeenRun){q.hasBeenRun=!0;var a=r.data(s);if(a)t?B(r):(a.closeAnimationTimeout=x(function(){B(r)},0,!1),r.data(s,a));H()}}var p,o,C=b(r);if(C)p=C.className,o=p+" "+c;if(!C||!y(o))i(),k(),G(),q();else{o=(" "+o).replace(/\s+/g,".");j||(j=l?l.parent():r.parent());o=N(o);var t=a=="addClass"||a=="removeClass",l=r.data(s)||{};if(z(r,j)||o.length===0)i(),k(),G(),q();else{var u=[];(t?!l.disabled&&(!l.running||!l.structural):1)&&g(o,function(e){if(!e.allowCancel||e.allowCancel(r,
a,c)){var b=e[a];a=="leave"?(e=b,b=null):e=e["before"+a.charAt(0).toUpperCase()+a.substr(1)];u.push({before:e,after:b})}});u.length===0?(i(),k(),G(),H()):(j=" "+p+" ",l.running&&(x.cancel(l.closeAnimationTimeout),B(r),I(l.animations),o=(p=t&&!l.structural)&&l.className==c&&a!=l.event,l.beforeComplete||o?(l.done||d)(!0):p&&(j=l.event=="removeClass"?j.replace(" "+l.className+" "," "):j+l.className+" ")),p=" "+c+" ",a=="addClass"&&j.indexOf(p)>=0||a=="removeClass"&&j.indexOf(p)==-1?(i(),k(),G(),H()):
(r.addClass(w),r.data(s,{running:!0,event:a,className:c,structural:!t,animations:u,done:m}),f(u,"before",m)))}}}function C(a){a=b(a);g(a.querySelectorAll("."+w),function(a){var a=h.element(a),c=a.data(s);c&&(I(c.animations),B(a))})}function I(a){g(a,function(a){a.beforeComplete||(a.beforeEnd||d)(!0);a.afterComplete||(a.afterEnd||d)(!0)})}function B(a){if(b(a)==b(q)){if(!i.disabled)i.running=!1,i.structural=!1}else a.removeClass(w),a.removeData(s)}function z(a,c){if(i.disabled)return!0;if(b(a)==b(q))return i.disabled||
i.running;do{if(c.length===0)break;var d=b(c)==b(q),j=d?i:c.data(s),j=j&&(!!j.disabled||!!j.running);if(d||j)return j;if(d)break}while(c=c.parent());return!0}q.data(s,i);t.$$postDigest(function(){t.$$postDigest(function(){i.running=!1})});var A=c.classNameFilter(),y=!A?function(){return!0}:function(a){return A.test(a)};return{enter:function(c,b,g,j){this.enabled(!1,c);a.enter(c,b,g);t.$$postDigest(function(){o("enter","ng-enter",c,b,g,d,j)})},leave:function(c,b){C(c);this.enabled(!1,c);t.$$postDigest(function(){o("leave",
"ng-leave",c,null,null,function(){a.leave(c)},b)})},move:function(c,b,g,j){C(c);this.enabled(!1,c);a.move(c,b,g);t.$$postDigest(function(){o("move","ng-move",c,b,g,d,j)})},addClass:function(c,b,d){o("addClass",b,c,null,null,function(){a.addClass(c,b)},d)},removeClass:function(c,b,d){o("removeClass",b,c,null,null,function(){a.removeClass(c,b)},d)},enabled:function(a,c){switch(arguments.length){case 2:if(a)B(c);else{var b=c.data(s)||{};b.disabled=!0;c.data(s,b)}break;case 1:i.disabled=!a;break;default:a=
!i.disabled}return!!a}}}]);c.register("",["$window","$sniffer","$timeout","$$animateReflow",function(c,i,f,p){function x(a,c){Q&&Q();T.push(c);var e=b(a),a=h.element(e);U.push(a);var e=a.data(L),j=e.stagger;R=Math.max(R,(e.itemIndex*(Math.max(j.animationDelay,j.transitionDelay)||0)+(e.maxDelay+e.maxDuration)*aa)*Y);e.animationCount=V;Q=p(function(){g(T,function(a){a()});var a=[],c=V;g(U,function(c){a.push(c)});f(function(){t(a,c);a=null},R,!1);T=[];U=[];Q=null;P={};R=0;V++})}function t(a,c){g(a,function(a){(a=
a.data(L))&&a.animationCount==c&&(a.closeAnimationFn||d)()})}function s(a,b){var j=b?P[b]:null;if(!j){var d=0,l=0,h=0,i=0,f,n,p,K;g(a,function(a){if(a.nodeType==q){a=c.getComputedStyle(a)||{};p=a[D+e];d=Math.max(o(p),d);K=a[D+k];f=a[D+G];l=Math.max(o(f),l);n=a[m+G];i=Math.max(o(n),i);var b=o(a[m+e]);b>0&&(b*=parseInt(a[m+H],10)||1);h=Math.max(b,h)}});j={total:0,transitionPropertyStyle:K,transitionDurationStyle:p,transitionDelayStyle:f,transitionDelay:l,transitionDuration:d,animationDelayStyle:n,animationDelay:i,
animationDuration:h};b&&(P[b]=j)}return j}function o(a){var c=0,a=h.isString(a)?a.split(/\s*,\s*/):[];g(a,function(a){c=Math.max(parseFloat(a)||0,c)});return c}function C(a){var c=a.parent(),e=c.data(X);e||(c.data(X,++W),e=W);return e+"-"+b(a).className}function I(a,c,e){var j=C(a),d=j+" "+c,l={},H=P[d]?++P[d].total:0;if(H>0){var h=c+"-stagger",l=j+" "+h;(j=!P[l])&&a.addClass(h);l=s(a,l);j&&a.removeClass(h)}e=e||function(a){return a()};a.addClass(c);e=e(function(){return s(a,d)});h=Math.max(e.transitionDelay,
e.animationDelay);j=Math.max(e.transitionDuration,e.animationDuration);if(j===0)return a.removeClass(c),!1;var i="";e.transitionDuration>0?b(a).style[D+k]="none":b(a).style[m]="none 0s";g(c.split(" "),function(a,c){i+=(c>0?" ":"")+a+"-active"});a.data(L,{className:c,activeClassName:i,maxDuration:j,maxDelay:h,classes:c+" "+i,timings:e,stagger:l,itemIndex:H});return!0}function B(a){var c=D+k,a=b(a);a.style[c]&&a.style[c].length>0&&(a.style[c]="")}function z(a){var c=m,a=b(a);a.style[c]&&a.style[c].length>
0&&(a.style[c]="")}function A(a,c,e){function j(){a.off(G,d);a.removeClass(i);var e=a;e.removeClass(c);e.removeData(L);var e=b(a),l;for(l in o)e.style.removeProperty(o[l])}function d(a){a.stopPropagation();var c=a.originalEvent||a,a=c.$manualTimeStamp||c.timeStamp||Date.now(),c=parseFloat(c.elapsedTime.toFixed(w));Math.max(a-n,0)>=f&&c>=H&&e()}var k=a.data(L),g=b(a);if(g.className.indexOf(c)==-1||!k)e();else{var m=k.timings,h=k.stagger,H=k.maxDuration,i=k.activeClassName,f=Math.max(m.transitionDelay,
m.animationDelay)*Y,n=Date.now(),G=O+" "+K,p=k.itemIndex,q="",o=[];if(m.transitionDuration>0){var D=m.transitionPropertyStyle;D.indexOf("all")==-1&&(q+=l+"transition-property: "+D+";",q+=l+"transition-duration: "+m.transitionDurationStyle+";",o.push(l+"transition-property"),o.push(l+"transition-duration"))}p>0&&(h.transitionDelay>0&&h.transitionDuration===0&&(q+=l+"transition-delay: "+y(m.transitionDelayStyle,h.transitionDelay,p)+"; ",o.push(l+"transition-delay")),h.animationDelay>0&&h.animationDuration===
0&&(q+=l+"animation-delay: "+y(m.animationDelayStyle,h.animationDelay,p)+"; ",o.push(l+"animation-delay")));o.length>0&&(m=g.getAttribute("style")||"",g.setAttribute("style",m+" "+q));a.on(G,d);a.addClass(i);k.closeAnimationFn=function(){j();e()};return j}}function y(a,c,e){var b="";g(a.split(","),function(a,j){b+=(j>0?",":"")+(e*c+parseInt(a,10))+"s"});return b}function v(a,c,e){if(I(a,c,e))return function(e){e&&(a.removeClass(c),a.removeData(L))}}function E(a,c,e){if(a.data(L))return A(a,c,e);else a.removeClass(c),
a.removeData(L),e()}function r(a,c,e){var b=v(a,c);if(b){var j=b;x(a,function(){B(a);z(a);j=E(a,c,e)});return function(a){(j||d)(a)}}else e()}function j(a,c){var e="",a=h.isArray(a)?a:a.split(/\s+/);g(a,function(a,b){a&&a.length>0&&(e+=(b>0?" ":"")+a+c)});return e}var l="",D,K,m,O;a.ontransitionend===n&&a.onwebkittransitionend!==n?(l="-webkit-",D="WebkitTransition",K="webkitTransitionEnd transitionend"):(D="transition",K="transitionend");a.onanimationend===n&&a.onwebkitanimationend!==n?(l="-webkit-",
m="WebkitAnimation",O="webkitAnimationEnd animationend"):(m="animation",O="animationend");var e="Duration",k="Property",G="Delay",H="IterationCount",X="$$ngAnimateKey",L="$$ngAnimateCSS3Data",w=3,aa=1.5,Y=1E3,V=0,P={},W=0,T=[],U=[],Q,R=0;return{allowCancel:function(a,c,e){var d=(a.data(L)||{}).classes;if(!d||["enter","leave","move"].indexOf(c)>=0)return!0;var l=a.parent(),k=h.element(b(a).cloneNode());k.attr("style","position:absolute; top:-9999px; left:-9999px");k.removeAttr("id");k.empty();g(d.split(" "),
function(a){k.removeClass(a)});k.addClass(j(e,c=="addClass"?"-add":"-remove"));l.append(k);a=s(k);k.remove();return Math.max(a.transitionDuration,a.animationDuration)>0},enter:function(a,c){return r(a,"ng-enter",c)},leave:function(a,c){return r(a,"ng-leave",c)},move:function(a,c){return r(a,"ng-move",c)},beforeAddClass:function(a,c,e){var b=v(a,j(c,"-add"),function(e){a.addClass(c);e=e();a.removeClass(c);return e});if(b)return x(a,function(){B(a);z(a);e()}),b;e()},addClass:function(a,c,e){return E(a,
j(c,"-add"),e)},beforeRemoveClass:function(a,c,e){var b=v(a,j(c,"-remove"),function(e){var b=a.attr("class");a.removeClass(c);e=e();a.attr("class",b);return e});if(b)return x(a,function(){B(a);z(a);e()}),b;e()},removeClass:function(a,c,e){return E(a,j(c,"-remove"),e)}}}])}])})(window,window.angular);/*
 AngularJS v1.2.11
 (c) 2010-2014 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(a,h){function n(a){var c=[];g(c,h.noop).chars(a);return c.join("")}function f(a){var c={},a=a.split(","),b;for(b=0;b<a.length;b++)c[a[b]]=!0;return c}function c(a,c){function d(a,k,j,m){k=h.lowercase(k);if(I[k])for(;e.last()&&B[e.last()];)g("",e.last());C[k]&&e.last()==k&&g("",k);(m=t[k]||!!m)||e.push(k);var f={};j.replace(w,function(a,c,e,k,d){f[c]=b(e||k||d||"")});c.start&&c.start(k,f,m)}function g(a,b){var k=0,d;if(b=h.lowercase(b))for(k=e.length-1;k>=0;k--)if(e[k]==b)break;if(k>=0){for(d=
e.length-1;d>=k;d--)c.end&&c.end(e[d]);e.length=k}}var m,f,e=[],k=a;for(e.last=function(){return e[e.length-1]};a;){f=!0;if(!e.last()||!z[e.last()]){if(a.indexOf("<\!--")===0)m=a.indexOf("--",4),m>=0&&a.lastIndexOf("--\>",m)===m&&(c.comment&&c.comment(a.substring(4,m)),a=a.substring(m+3),f=!1);else if(J.test(a)){if(m=a.match(J))a=a.replace(m[0],""),f=!1}else if(u.test(a)){if(m=a.match(s))a=a.substring(m[0].length),m[0].replace(s,g),f=!1}else if(i.test(a)&&(m=a.match(q)))a=a.substring(m[0].length),
m[0].replace(q,d),f=!1;f&&(m=a.indexOf("<"),f=m<0?a:a.substring(0,m),a=m<0?"":a.substring(m),c.chars&&c.chars(b(f)))}else a=a.replace(RegExp("(.*)<\\s*\\/\\s*"+e.last()+"[^>]*>","i"),function(a,e){e=e.replace(F,"$1").replace(M,"$1");c.chars&&c.chars(b(e));return""}),g("",e.last());if(a==k)throw p("badparse","The sanitizer was unable to parse the following block of html: {0}",a);k=a}g()}function b(a){if(!a)return"";var c=r.exec(a),a=c[1],b=c[3];if(c=c[2])E.innerHTML=c.replace(/</g,"&lt;"),c="textContent"in
E?E.textContent:E.innerText;return a+c+b}function d(a){return a.replace(/&/g,"&amp;").replace(x,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function g(a,c){var b=!1,g=h.bind(a,a.push);return{start:function(a,j,e){a=h.lowercase(a);!b&&z[a]&&(b=a);!b&&A[a]===!0&&(g("<"),g(a),h.forEach(j,function(e,b){var j=h.lowercase(b),f=a==="img"&&j==="src"||j==="background";if(v[j]===!0&&(y[j]!==!0||c(e,f)))g(" "),g(b),g('="'),g(d(e)),g('"')}),g(e?"/>":">"))},end:function(a){a=
h.lowercase(a);!b&&A[a]===!0&&(g("</"),g(a),g(">"));a==b&&(b=!1)},chars:function(a){b||g(d(a))}}}var p=h.$$minErr("$sanitize"),q=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,s=/^<\s*\/\s*([\w:-]+)[^>]*>/,w=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,i=/^</,u=/^<\s*\//,F=/<\!--(.*?)--\>/g,J=/<!DOCTYPE([^>]*?)>/i,M=/<!\[CDATA\[(.*?)]]\>/g,x=/([^\#-~| |!])/g,t=f("area,br,col,hr,img,wbr"),N=f("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),
o=f("rp,rt"),C=h.extend({},o,N),I=h.extend({},N,f("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),B=h.extend({},o,f("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),z=f("script,style"),A=h.extend({},t,I,B,C),y=f("background,cite,href,longdesc,src,usemap"),v=h.extend({},
y,f("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),E=document.createElement("pre"),r=/^(\s*)([\s\S]*?)(\s*)$/;h.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(a){return function(b){var d=[];c(b,g(d,function(c,
b){return!/^unsafe/.test(a(c,b))}));return d.join("")}}]});h.module("ngSanitize").filter("linky",["$sanitize",function(a){var c=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,b=/^mailto:/;return function(d,g){function f(a){a&&p.push(n(a))}function e(a,c){p.push("<a ");h.isDefined(g)&&(p.push('target="'),p.push(g),p.push('" '));p.push('href="');p.push(a);p.push('">');f(c);p.push("</a>")}if(!d)return d;for(var k,i=d,p=[],o,q;k=i.match(c);)o=k[0],k[2]==k[3]&&(o="mailto:"+o),q=k.index,
f(i.substr(0,q)),e(o,k[0].replace(b,"")),i=i.substring(q+k[0].length);f(i);return a(p.join(""))}}])})(window,window.angular);setTimeout(function(){resizeIframe()},100);$(window).resize(function(){resizeIframe()});function resizeIframe(){var a=(new $(window)).height();a>600&&(a-=450,$(".CodeMirror-wrapping").css("height",a+"px"))}
var CodeMirrorConfig=window.CodeMirrorConfig||{},CodeMirror=function(){function a(a,b){for(var d in b)a.hasOwnProperty(d)||(a[d]=b[d])}function h(a,b){for(var d=0;d<a.length;d++)b(a[d])}function n(a){var b=document.createElement("DIV"),d=document.createElement("DIV");b.style.position="absolute";b.style.height="100%";if(b.style.setExpression)try{b.style.setExpression("height","this.previousSibling.offsetHeight + 'px'")}catch(g){}b.style.top="0px";b.style.overflow="hidden";a.appendChild(b);d.className=
"CodeMirror-line-numbers";b.appendChild(d);return b}function f(c,b){if(b.dumbTabs)b.tabMode="spaces";else if(b.normalTab)b.tabMode="default";this.options=b=b||{};a(b,CodeMirrorConfig);var d=this.frame=document.createElement("IFRAME");if(b.iframeClass)d.className=b.iframeClass;d.frameBorder=0;d.src="javascript:false;";d.style.border="0";d.style.width="100%";d.style.height="100%";d.style.display="block";var g=this.wrapping=document.createElement("DIV");g.style.position="relative";g.className="CodeMirror-wrapping";
g.style.width=b.width;g.style.height=b.height;c.appendChild?c.appendChild(g):c(g);g.appendChild(d);if(b.lineNumbers)this.lineNumbers=n(g);d.CodeMirror=this;this.win=d.contentWindow;if(typeof b.parserfile=="string")b.parserfile=[b.parserfile];if(typeof b.stylesheet=="string")b.stylesheet=[b.stylesheet];var f=['<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head>'];f.push('<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>');h(b.stylesheet,
function(a){f.push('<link rel="stylesheet" type="text/css" href="'+a+'"/>')});h(b.basefiles.concat(b.parserfile),function(a){f.push('<script type="text/javascript" src="'+b.path+a+'"><\/script>')});f.push('</head><body style="border-width: 0;" class="editbox" spellcheck="'+(b.disableSpellcheck?"false":"true")+'"></body></html>');d=this.win.document;d.open();d.write(f.join(""));d.close()}a(CodeMirrorConfig,{stylesheet:["/css/codemirror/xmlcolors.css"],path:"",parserfile:["/js/plugins/codemirror/parsexml.js"],
basefiles:["/js/plugins/codemirror/util.js","/js/plugins/codemirror/stringstream.js","/js/plugins/codemirror/select.js","/js/plugins/codemirror/undo.js","/js/plugins/codemirror/editor.js","/js/plugins/codemirror/tokenize.js"],iframeClass:null,passDelay:500,passTime:25,lineNumberDelay:500,lineNumberTime:20,continuousScanning:!1,saveFunction:null,onChange:null,undoDepth:50,undoDelay:800,disableSpellcheck:!0,textWrapping:!0,readOnly:!1,width:"",height:"300px",autoMatchParens:!1,parserConfig:null,tabMode:"shift",
reindentOnLoad:!1,activeTokens:null,cursorActivity:null,lineNumbers:!1,indentUnit:5});f.prototype={init:function(){this.options.initCallback&&this.options.initCallback(this);this.options.lineNumbers&&this.activateLineNumbers();this.options.reindentOnLoad&&this.reindent()},getCode:function(){return this.editor.getCode()},setCode:function(a){this.editor.importCode(a)},selection:function(){this.focusIfIE();return this.editor.selectedText()},reindent:function(){this.editor.reindent()},reindentSelection:function(){this.focusIfIE();
this.editor.reindentSelection(null)},focusIfIE:function(){this.win.select.ie_selection&&this.focus()},focus:function(){this.win.focus();this.editor.selectionSnapshot&&this.win.select.setBookmark(this.win.document.body,this.editor.selectionSnapshot)},replaceSelection:function(a){this.focus();this.editor.replaceSelection(a);return!0},replaceChars:function(a,b,d){this.editor.replaceChars(a,b,d)},getSearchCursor:function(a,b,d){return this.editor.getSearchCursor(a,b,d)},undo:function(){this.editor.history.undo()},
redo:function(){this.editor.history.redo()},historySize:function(){return this.editor.history.historySize()},clearHistory:function(){this.editor.history.clear()},grabKeys:function(a,b){this.editor.grabKeys(a,b)},ungrabKeys:function(){this.editor.ungrabKeys()},setParser:function(a){this.editor.setParser(a)},setSpellcheck:function(a){this.win.document.body.spellcheck=a},setTextWrapping:function(a){if(a!=this.options.textWrapping)this.win.document.body.style.whiteSpace=a?"":"nowrap",this.options.textWrapping=
a,this.lineNumbers&&(this.setLineNumbers(!1),this.setLineNumbers(!0))},setIndentUnit:function(a){this.win.indentUnit=a},setUndoDepth:function(a){this.editor.history.maxDepth=a},setTabMode:function(a){this.options.tabMode=a},setLineNumbers:function(a){if(a&&!this.lineNumbers)this.lineNumbers=n(this.wrapping),this.activateLineNumbers();else if(!a&&this.lineNumbers)this.wrapping.removeChild(this.lineNumbers),this.wrapping.style.marginLeft="",this.lineNumbers=null},cursorPosition:function(a){this.focusIfIE();
return this.editor.cursorPosition(a)},firstLine:function(){return this.editor.firstLine()},lastLine:function(){return this.editor.lastLine()},nextLine:function(a){return this.editor.nextLine(a)},prevLine:function(a){return this.editor.prevLine(a)},lineContent:function(a){return this.editor.lineContent(a)},setLineContent:function(a,b){this.editor.setLineContent(a,b)},insertIntoLine:function(a,b,d){this.editor.insertIntoLine(a,b,d)},selectLines:function(a,b,d,g){this.win.focus();this.editor.selectLines(a,
b,d,g)},nthLine:function(a){for(var b=this.firstLine();a>1&&b!==!1;a--)b=this.nextLine(b);return b},lineNumber:function(a){for(var b=0;a!==!1;)b++,a=this.prevLine(a);return b},jumpToLine:function(a){this.selectLines(this.nthLine(a),0);this.win.focus()},currentLine:function(){return this.lineNumber(this.cursorPosition().line)},activateLineNumbers:function(){function a(){for(var c=f;c.parentNode;c=c.parentNode);if(!i.parentNode||c!=document||!h.Editor){try{M()}catch(b){}clearInterval(sizeInterval)}else if(i.offsetWidth!=
J)J=i.offsetWidth,i.style.left="-"+(f.parentNode.style.marginLeft=J+"px")}function b(){i.scrollTop=w.scrollTop||n.documentElement.scrollTop||0}function d(){function a(){for(var d=50+Math.max(w.offsetHeight,f.offsetHeight);u.offsetHeight<d;)u.appendChild(document.createElement("DIV")),u.lastChild.innerHTML=c++;b()}var c=1,d=h.addEventHandler(h,"scroll",a,!0),g=h.addEventHandler(h,"resize",a,!0);M=function(){d();g()}}function g(){function a(c){n||(n=u.appendChild(document.createElement("DIV")));n.innerHTML=
c;z=n.offsetHeight+n.offsetTop;n=n.nextSibling}function c(){if(u.parentNode&&u.parentNode==F.lineNumbers){for(var d=(new Date).getTime()+F.options.lineNumberTime;i;){for(a(s++);i&&!h.isBR(i);i=i.nextSibling)for(var g=i.offsetTop+i.offsetHeight;g-3>z;)a("&nbsp;");if(i)i=i.nextSibling;if((new Date).getTime()>d){A=setTimeout(c,F.options.lineNumberDelay);return}if($("#importComputer").hasClass("current")||$("#importWeb").hasClass("current"))return}for(d=50+Math.max(w.offsetHeight,f.offsetHeight);n||u.offsetHeight<
d;)a(s++);b()}}function d(){$("#inText",top.document).val(mirror.getCode());b();i=w.firstChild;n=u.firstChild;z=0;s=1;c()}function g(){A&&clearTimeout(A);d()}var i,n,s,z;d();var A=null;F.updateNumbers=g;var y=h.addEventHandler(h,"scroll",b,!0),v=h.addEventHandler(h,"resize",g,!0);M=function(){A&&clearTimeout(A);if(F.updateNumbers==g)F.updateNumbers=null;y();v()}}var f=this.frame,h=f.contentWindow,n=h.document,w=n.body,i=this.lineNumbers,u=i.firstChild,F=this,J=null,M=function(){};a();sizeInterval=
setInterval(a,500);(this.options.textWrapping?g:d)()}};f.InvalidLineHandle={toString:function(){return"CodeMirror.InvalidLineHandle"}};f.replace=function(a){typeof a=="string"&&(a=document.getElementById(a));return function(b){a.parentNode.replaceChild(b,a)}};f.fromTextArea=function(a,b){function d(b){a.nextSibling?a.parentNode.insertBefore(b,a.nextSibling):a.parentNode.appendChild(b)}typeof a=="string"&&(a=document.getElementById(a));b=b||{};if(a.style.width&&b.width==null)b.width=a.style.width;
if(a.style.height&&b.height==null)b.height=a.style.height;if(b.content==null)b.content=a.value;setTimeout(function(){return mirror=new f(d,b)},1);if(a.form){var g=function(){a.value=mirror.getCode()};typeof a.form.addEventListener=="function"?a.form.addEventListener("submit",g,!1):a.form.attachEvent("onsubmit",g)}a.style.display="none"};f.isProbablySupported=function(){var a;return window.opera?Number(window.opera.version())>=9.52:/Apple Computers, Inc/.test(navigator.vendor)&&(a=navigator.userAgent.match(/Version\/(\d+(?:\.\d+)?)\./))?
Number(a[1])>=3:document.selection&&window.ActiveXObject&&(a=navigator.userAgent.match(/MSIE (\d+(?:\.\d*)?)\b/))?Number(a[1])>=6:(a=navigator.userAgent.match(/gecko\/(\d{8})/i))?Number(a[1])>=20050901:(a=navigator.userAgent.match(/AppleWebKit\/(\d+)/))?Number(a[1])>=525:null};return f}();angular.module("gallery",["ngAnimate","ngSanitize"]).config(["$locationProvider",function(a){a.html5Mode(!0).hashPrefix("!")}]);(function(a){a.service("GalleryItemsSvc",["$http","isAutoresponder","entityId","snap",function(a,n,f,c){this.getRecentEmails=function(b){return a.get((n?"/automation/gallery/RecentEmails/":"/campaigns/gallery/RecentEmails/")+f+(b?"/"+b:"/1")+"/"+c)};this.getDesigns=function(b){return a.get((n?"/automation/gallery/designs/":"/campaigns/gallery/designs/")+f+(b?"/"+b:"/1")+"/"+c)};this.getTemplates=function(b){return a.get((n?"/automation/gallery/templates/":"/campaigns/gallery/templates/")+f+(b?"/"+
b:"/1")+"/"+c)}}])})(angular.module("gallery"));(function(a,h){h.directive("csInfiniteScroll",["$window","$timeout",function(h,f){return{restrict:"A",replace:!1,scope:{handler:"&?csInfiniteScroll",gap:"@csInfiniteScrollGap",enabled:"=csInfiniteScrollEnabled"},link:function(c){function b(){c.handler()().success(function(a){a&&a.length&&f(function(){var a=h.document.body;a.scrollHeight<a.clientHeight+d&&b()},0)})}var d=parseInt(c.gap,0);a.element(h).on("scroll",function(){if(c.enabled){var a=h.document.body;a.scrollHeight<a.clientHeight+(h.document.documentElement&&
h.document.documentElement.scrollTop||a.scrollTop)+d&&c.handler&&c.handler()()}});b()}}}])})(angular,angular.module("gallery"));(function(a,h){h.directive("csImagePreload",["$http","$timeout",function(a,f){return{restrict:"A",templateUrl:"/js/modules/gallery/templates/imagePreload.html",replace:!0,scope:{url:"@csImagePreload",exists:"=csImagePreloadExists",pollUrl:"@csImagePreloadPollUrl",alt:"@csImagePreloadAlt",resolutions:"=csImagePreloadResolutions"},link:function(c){function b(){if(c.exists){var d=new Image;d.onload=function(){f(function(){c.src=c.url;var a=[],b;for(b in c.resolutions)a.push(c.resolutions[b]+" "+b);c.srcset=
a.join(",")})};d.src=c.url}else a.get(c.pollUrl).success(function(a){a.screenshotExists?(c.exists=!0,b()):f(b,1E4)})}b()}}}])})(angular,angular.module("gallery"));(function(a,h){h.directive("csAjaxUpload",[function(){return{restrict:"A",scope:{onStart:"&csAjaxUploadStartHandler",onComplete:"&csAjaxUploadCompleteHandler"},link:function(a,f){f.ajaxUpload({onStart:a.onStart(),onComplete:a.onComplete()})}}}])})(angular,angular.module("gallery"));(function(a,h){h.directive("csFixElement",["$timeout","$window",function(a,f){return{restrict:"A",scope:{top:"=?csFixElement"},link:function(a,b,d){function g(){$(f).height()>=h&&$(f).scrollTop()>a.top?b.addClass("is-fixed"):b.removeClass("is-fixed")}a.top=a.top||b.offset().top;var h=d.csFixElementMinHeight||800;$(f).scroll(function(){g()});$(f).resize(function(){g()})}}}])})(angular,angular.module("gallery"));angular.module("gallery").controller("GalleryController",["$scope","$compile","$window","$document","$location","$timeout","GalleryItemsSvc","defaultTab","validTabs","defaultCategory","validCategories","step2LegacyService","config",function(a,h,n,f,c,b,d,g,p,q,s,w,i){function u(){n.scrollTo(0,Math.min(n.scrollY,318-l[0].offsetTop))}function F(){var e=n.innerHeight-l[0].offsetTop-99;e<0&&(e=0);a.minHeightForScroll={"min-height":e+"px"}}function J(){a.sideBarStick=$(n).height()>a.minFixScreenHeight?
j:j+$(".bar-top").height()}function M(a){b(function(){h(angular.element(a))(angular.element("#gallery-container").scope())},0)}function x(){i.getEditableContentUrl&&$("#editHtmlDiv").load(i.getEditableContentUrl,null,function(){resizeIframe();M("#editHtmlDiv")})}function t(a){a?($("#cr_loading_screen").fadeIn("fast"),$(".js-site-header").css("z-index","1")):($("#cr_loading_screen").fadeOut("fast"),$(".js-site-header").css("z-index","2"))}function N(a){hideMessages();pages[a].load();"editHtml"===a&&
!K&&(K=!0,x())}function o(c,d){b(function(){a.selectImportStep(v===c?void 0:c,d)});N(c)}function C(){var a=$("#approveContentDiv");a.load(i.approveContentUrl,function(){a.find(".preview-popup").popup({height:600,width:950});t(!1);o("approveContent");M("#approveContentDiv")})}function I(c){$(JSON.parse(c)).parseJson({onError:function(){t(!1)},onSuccess:function(){a.approvalProceed="yes";C();x()}})}function B(){var a=c.hash().split("-").filter(function(a){return a}),b,d,f=!1;switch(a.length){case 0:b=
g;d=y===b?q:void 0;f=!0;break;case 1:b=a[0];break;case 2:b=a[0],d=a[1]}return{tab:b,category:d,usedDefaultTab:f}}function z(){$("#cr_send_confirm").hide();a.sendTestConfirmation=!1}function A(c){$(JSON.parse(c)).parseJson({onSuccess:function(){a.$apply(function(){a.showSendTest=!1;$("#cr_send_confirm").fadeIn();a.sendTestConfirmation=!0;a.sendTestErrorMessage="";$("#txtTestCampaign").val("")});b(z,4E3)},onError:function(){$("#txtTestCampaign").focus();b(z,0)},errorSetup:{renderer:function(c){$("#txtTestCampaign").addClass("clearfixError");
a.sendTestErrorMessage=c[0]}},successSetup:{renderer:function(){}}})}var y="gallery",v="import",E=!1,r={},j=$(".bar-top").offset().top;a.recentEmails=[];a.designs=[];a.featuredDesigns=[];a.templates=[];a.minFixScreenHeight=800;a.hideMenu=i.isSingleEdit;a.importText=function(c,d){b(function(){ajax(c,"POST","",function(c){a.$apply(function(){$(JSON.parse(c)).parseJson()})},d,"")},1500)};a.hasContent=i.hasContent;a.format=i.format;a.oldBuilderFormat=4;a.columnCount=n.innerWidth>=1400?4:3;var l=$(".side-bar--fixed");
F();a.recentEmailsSource=function(){return a.currentTab=="previous"?a.recentEmails:[]};a.templatesSource=function(){return a.currentTab=="templates"?a.templates:[]};a.designsSource=function(){return a.currentTab==y?a.currentDesign==="featured"?a.featuredDesigns:a.designs:[]};d.getDesigns().success(function(c){a.designs=c;a.designs.initialized=!0;a.featuredDesigns=angular.copy(c)}).error(function(){a.designs.initialized=!0});J();var D=function(c,b){if(!r[b]){r[b]=!0;var d=b(Math.ceil(c.length/a.pageSize)+
1);d.success(function(a){Array.prototype.push.apply(c,a);c.initialized=!0;r[b]=!1}).error(function(){r[b]=!1;c.initialized=!0});return d}},K=!1;a.getRecentEmails=function(){return D(a.recentEmails,d.getRecentEmails)};a.getTemplates=function(){return D(a.templates,d.getTemplates)};a.placeholders=function(c,b){var d=c.length;if(b&&b!="featured")for(var f=0;f<c.length;f++)c[f].categoryKey!=b&&d--;d=a.columnCount-d;return 0<d&&c.initialized?Array(d):[]};a.selectDesignCategory=function(b){document.title=
i.defaultTitle;s.indexOf(b)===-1&&(b=q?q:"featured");a.currentDesign=b;a.currentTab=y;c.hash(y+"-"+b);c.replace();a.currentUrl=c.$$url;u()};a.selectImportStep=function(b,d){a.currentDesign=b;a.currentTab=v;c.hash(v+(b?"-"+b:""));d&&c.replace();N(b||v);a.currentUrl=c.$$url;u()};a.selectTab=function(b){document.title=i.defaultTitle;var d=b.split("/")[0];p.indexOf(d)===-1&&(b=g);a.currentTab=b;a.currentDesign=null;a.currentImportTab=b.split("/")[0];c.hash(a.currentTab);c.replace();b==="editHtml"&&w.loadHtmlIfNeeded&&
w.loadHtmlIfNeeded();u()};a.$on("$locationChangeSuccess",function(){if(E)E=!1;else{var b=B();if(!(a.currentTab==b.tab&&a.currentDesign==b.category))a.hideMenu=i.isSingleEdit&&(v===b.tab&&"editHtml"===b.category||"editText"===b.tab),b.tab==y?b.category?a.selectDesignCategory(b.category):a.selectDesignCategory("featured"):b.tab==v?o(b.category||v,b.usedDefaultTab):b.tab&&a.selectTab(b.tab)}});$(n).resize(function(){a.$apply(function(){J();F();a.columnCount=n.innerWidth>=1400?4:3})});a.goToUrl=function(a,
b){var d=c.hash();E=!0;d=a+(-1===a.indexOf("?")?"?":"&")+"category="+d;b?n.location.href=d:n.location.replace(d)};a.flipConfirmTypes={keepContent:0,noKeepContent:1};var m=[{type:a.flipConfirmTypes.keepContent,oldToOld:!1},{type:a.flipConfirmTypes.noKeepContent,oldToOld:!1}],O=function(b){return void 0===a.flippedItemId||a.flippedItemId===b.id?m[1]:m[0]};a.flipConfirmType=function(a){return O(a).type};a.oldBuilderToOldBuilder=function(a){return O(a).oldToOld};a.flipOrSelectDesign=function(b){if(a.hasContent){a.flippedItemId=
b.id;var c=a.format===b.format&&a.oldBuilderFormat===b.format,b=!c&&a.format===b.format?a.flipConfirmTypes.keepContent:a.flipConfirmTypes.noKeepContent;m[0]=m[1];m[1]={type:b,oldToOld:c}}else a.selectDesign(b,b.clickThroughUrl)};a.unflip=function(){a.flippedItemId=void 0};a.selectDesign=function(b,c){a.selectedId=b.id;a.goToUrl(c,!0);a.unflip()};a.feedbackBannerClosed=function(b){$.get(b);a.closeFeedbackbanner=!0;a.removingBannerClass="is-removing"};a.submitImportForm=function(){a.isFileImport?$("#importFromComp").submit():
ajax(i.webImportUrl,"POST","",function(a){I(a,"webImport")},"importFromWeb",function(){t(!0);hideMessages()})};a.inlineCss=!0;a.setFileImport=function(){a.isFileImport=!0;a.htmlImportWebUrl=""};a.setWebImport=function(){a.isFileImport=!1;$("#htmlFile").val("");$("#zipFile").val("")};a.showLoadingScreenAndHideMessages=function(){t(!0);hideMessages()};a.completeImportHtml=function(b){$(b).parseJson({errorSetup:{title:"Sorry, we couldn't import your "+(i.isWorkflowEmail?"email":"campaign")+" content because..."},
onError:function(){t(!1);$("#htmlFile, #zipFile").val("")},onSuccess:function(){b.Data!==null&&b.Data.redirectUrl!==null?window.location.href=b.Data.redirectUrl:(a.approvalProceed="yes",C(),x())}})};a.setImportedText=function(){a.showTinyLoader=!0;$.ajax({url:i.generateTextUrl,type:"GET",success:function(c){b(function(){$("[name=textContent]").val(c)},0);b(function(){a.showTinyLoader=!1},200)}})};a.submitApproval=function(b){if("yes"===a.approvalProceed)switch(b){case "submit":$.post(i.approveContentUrl,
null,function(b){$(b).parseJson({onSuccess:function(){o("defineTextContent");a.$apply()}})},"json");break;case "snapshot":a.goToUrl(i.snapshotUrl);break;default:o("defineTextContent")}else a.approvalProceed==="edit"?o("editHtml"):o(v)};a.editedHtmlImport=function(a){t(!0);hideMessages();b(function(){ajax(a,"POST","",function(a){I(a,"editHtml")},"editableImport","")},1500)};a.showSendTest=!1;a.sendTestConfirmation=!1;a.sendTestErrorMessage="";a.toggleSendTest=function(){if(!a.sendTestConfirmation)a.showSendTest=
!a.showSendTest};a.sendTestEmail=function(a,b,c){c.preventDefault();var c="send",d="";a&&(c="sendtemporaryimport",d="&newFormat="+$("#importFromComp input[name='newFormat']").val());ajax("/campaigns/test/"+c+"/"+i.cId+"/?sendOneVersion="+b+d,"POST","",A,"testEmailForm",function(){$("#cr_or_other").html("Sending test email...")})};a.galleryItemClicked=function(b,c){b.stopPropagation();b.target.className.indexOf("c-flip-3d")>=0&&a.flipOrSelectDesign(c)};f.on("click",function(){void 0!==a.flippedItemId&&
a.$apply(function(){a.unflip()})})}]);
